---
marp: true
header: "～DDDとEFCoreから考える値オブジェクトのすゝめ～"
theme: default
paginate: true
style: |
  section {
    background-color: #f1f0eb;
  }
  .columns {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 32px;
    align-items: start;
  }
  .center {
    display: flex;
    align-items: center;
    justify-content: center;
    text-align: center;   
  }
  .small {
    font-size: 16px;
  } 
  .midium {
    font-size: 20px;
  } 
  .large {
    font-size: 26px;
  } 
---

# ドメインモデルについての率直な感想
- ファイルが増えて追いずらそう、めんどい、やったことない、
- 学習コストがかかる・・・
- モデルに対する哲学的議論より手を動かしたい

---

## ドメインモデルは**どこでも使えばいいってものではない**
- ただしアーキテクチャの選択について理由を明確にするべき
- 同じアプリケーション内で、機能(区切られた文脈)ごとに変えてもよい
  - CQRS観点でQuery（読み取り側）だけアクティブレコードにしてもよい
  
![h:380px](image-2.png)

---
## ドメインモデルをいつやるか
- 今その必要がないからと言って、ずっとその必要がないとは限りません
  
![alt text](image-10.png)

---

# プロのキッチンを整える

### 業務ロジックが凝集され、カオスにならないコードベース
  - 美しいまな板のようなもの
### 業務エキスパートと深く相互理解された洗練されたユビキタス言語
### それらが生み出す役に立つ（業務ロジックを雄弁に語ることができる）モデル
  - 切れ味のいい包丁のようなもの

# これらが整うことで、いつでも新しく魅力的な料理（機能）を産み出すことができる

--- 
# 貧血ドメインモデル
- ただEFCoreを使うだけだと、トランザクションスクリプトとアクティブレコードの悪いところを両方引き継ぐ
- 最初はシンプルな機能でも、改修を繰り返すうちに、徐々にコードが汚れる
  
### 汚れたまな板とさびた包丁で料理するようなことになっていく
  - どんなに料理人（エンジニア）の腕が良くても、
  スピード（生産性）が落ち、
  出来上がる料理（機能）の品質は低下する

---

# まとめ

- **自己文書化**された雄弁なコードにより
    - 将来の辛く苦しい仕事を回避すべき
    - スピーディーな開発生産性を**維持**できる
- **中核的領域**で**業務そのものの複雑さに向き合う**ときに**ドメインモデル**を実践する
    - どこでもやるというわけではない
- **ドメインモデル**の実践により、POCOで**業務ロジック**を記述することに集中できる
    - 永続化ではなく、**業務ロジックこそがアプリケーション**である
- EFCoreを利用しているのは、複雑なリレーションをオブジェクトとして表現し、さらにオブジェクトを値オブジェクトとして業務ロジックを表現するため
## まずは、**値オブジェクト**を使っていこう